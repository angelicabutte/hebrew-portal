<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shrek Hebrew Games</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .game-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .game-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }
        
        .game-card h2 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.5em;
        }
        
        .game-card p {
            color: #666;
            line-height: 1.6;
        }
        
        .game-container {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        
        .game-container.active {
            display: block;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .game-title {
            font-size: 1.8em;
            color: #667eea;
        }
        
        .back-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
        }
        
        .back-btn:hover {
            background: #5568d3;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .stat {
            background: #f5f5f5;
            padding: 15px 30px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        /* Speed Quiz Styles */
        .question-card {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .hebrew-text {
            font-size: 3em;
            margin-bottom: 10px;
            color: #333;
            font-weight: bold;
        }
        
        .translit-text {
            font-size: 1.5em;
            color: #888;
            font-style: italic;
            margin-bottom: 20px;
        }
        
        .context-hint {
            color: #666;
            font-style: italic;
            margin-bottom: 20px;
        }
        
        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .option-btn {
            background: white;
            border: 2px solid #ddd;
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s;
        }
        
        .option-btn:hover {
            border-color: #667eea;
            transform: scale(1.02);
        }
        
        .option-btn.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }
        
        .option-btn.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }
        
        .option-btn:disabled {
            cursor: not-allowed;
        }
        
        /* Matching Game Styles */
        .matching-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .match-card {
            background: #667eea;
            color: white;
            padding: 25px 10px;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            font-size: 1.3em;
            transition: all 0.3s;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            line-height: 1.4;
        }
        
        .match-card .card-main {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .match-card .card-sub {
            font-size: 0.7em;
            opacity: 0.9;
            font-style: italic;
        }
        
        .match-card:hover {
            transform: scale(1.05);
        }
        
        .match-card.selected {
            background: #ffc107;
            color: #333;
        }
        
        .match-card.matched {
            background: #4caf50;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .match-card.wrong {
            animation: shake 0.5s;
            background: #f44336;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        /* Fill in Blank Styles */
        .sentence-display {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .sentence-text {
            font-size: 2em;
            line-height: 1.8;
            margin-bottom: 15px;
            direction: rtl;
            color: #333;
        }
        
        .blank-placeholder {
            display: inline-block;
            min-width: 180px;
            border-bottom: 4px solid #667eea;
            background: #e3f2fd;
            padding: 5px 15px;
            margin: 0 10px;
            font-weight: bold;
            color: #667eea;
            border-radius: 5px;
        }
        
        .sentence-translit {
            font-size: 1.3em;
            color: #666;
            font-style: italic;
            margin-bottom: 15px;
            direction: ltr;
        }
        
        .english-hint {
            color: #666;
            font-size: 1.2em;
            margin-top: 20px;
        }
        
        /* Results Screen */
        .results-screen {
            text-align: center;
            padding: 40px;
        }
        
        .results-score {
            font-size: 4em;
            color: #4caf50;
            margin: 20px 0;
        }
        
        .results-message {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 30px;
        }
        
        .play-again-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
            margin: 10px;
        }
        
        .play-again-btn:hover {
            background: #5568d3;
        }
        
        /* Timer */
        .timer {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
        }
        
        .timer.warning {
            color: #f44336;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .matching-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .options {
                grid-template-columns: 1fr;
            }
            
            .hebrew-text {
                font-size: 2em;
            }
            
            .match-card {
                font-size: 1.1em;
                min-height: 100px;
            }
            
            .sentence-text {
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üßÖ Shrek Hebrew Games</h1>
            <p>Learn Hebrew vocabulary through fun games!</p>
        </div>
        
        <!-- Game Selection Screen -->
        <div id="gameSelector" class="game-selector">
            <div class="game-card" onclick="startGame('speedQuiz')">
                <h2>‚ö° Speed Quiz</h2>
                <p>Multiple choice questions. Race against the clock!</p>
            </div>
            
            <div class="game-card" onclick="startGame('matching')">
                <h2>üé¥ Matching Pairs</h2>
                <p>Match Hebrew words with their English meanings!</p>
            </div>
            
            <div class="game-card" onclick="startGame('fillBlank')">
                <h2>üìù Fill the Blank</h2>
                <p>Complete sentences from Shrek scenes!</p>
            </div>
            
            <div class="game-card" onclick="startGame('speedRound')">
                <h2>üèÜ Speed Round Mix</h2>
                <p>Random game types. Ultimate challenge!</p>
            </div>
        </div>
        
        <!-- Speed Quiz Game -->
        <div id="speedQuiz" class="game-container">
            <div class="game-header">
                <h2 class="game-title">‚ö° Speed Quiz</h2>
                <button class="back-btn" onclick="backToMenu()">‚Üê Back</button>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-label">Score</div>
                    <div class="stat-value" id="quizScore">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Question</div>
                    <div class="stat-value" id="quizProgress">1/10</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Time</div>
                    <div class="stat-value timer" id="quizTimer">60</div>
                </div>
            </div>
            
            <div id="quizContent"></div>
        </div>
        
        <!-- Matching Game -->
        <div id="matching" class="game-container">
            <div class="game-header">
                <h2 class="game-title">üé¥ Matching Pairs</h2>
                <button class="back-btn" onclick="backToMenu()">‚Üê Back</button>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-label">Pairs Found</div>
                    <div class="stat-value" id="matchScore">0/6</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Moves</div>
                    <div class="stat-value" id="matchMoves">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Time</div>
                    <div class="stat-value timer" id="matchTimer">0</div>
                </div>
            </div>
            
            <div id="matchingGrid" class="matching-grid"></div>
        </div>
        
        <!-- Fill in Blank Game -->
        <div id="fillBlank" class="game-container">
            <div class="game-header">
                <h2 class="game-title">üìù Fill the Blank</h2>
                <button class="back-btn" onclick="backToMenu()">‚Üê Back</button>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-label">Score</div>
                    <div class="stat-value" id="blankScore">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Question</div>
                    <div class="stat-value" id="blankProgress">1/10</div>
                </div>
            </div>
            
            <div id="blankContent"></div>
        </div>
        
        <!-- Speed Round Mix -->
        <div id="speedRound" class="game-container">
            <div class="game-header">
                <h2 class="game-title">üèÜ Speed Round Mix</h2>
                <button class="back-btn" onclick="backToMenu()">‚Üê Back</button>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-label">Total Score</div>
                    <div class="stat-value" id="speedScore">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Round</div>
                    <div class="stat-value" id="speedRoundNum">1/5</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Game Type</div>
                    <div class="stat-value" id="speedType" style="font-size: 1.2em;">-</div>
                </div>
            </div>
            
            <div id="speedContent"></div>
        </div>
    </div>

    <script>
        // Load vocabulary data from the Anki file
        const vocabData = `◊ò◊ï÷π◊ë|tov|good; pleasant; appropriate||adjective|◊î◊ô◊î ◊ò◊ï◊ë ◊ú◊®◊ê◊ï◊™ ◊ê◊™ ◊ñ◊î|haya tov lirot et ze|That really made me feel good to see that|00:07:51|shrek1 top50
◊ô◊ï÷π◊ì÷µ◊¢÷∑|yodea|know; understand||verb|◊ê◊™◊î ◊ô◊ï◊ì◊¢ ◊û◊î ◊î◊ï◊ê ◊¢◊ú◊ï◊ú ◊ú◊¢◊©◊ï◊™|ata yodea ma hu alul la'asot|Do you know what that thing can do to you|00:03:39|shrek1 top50
◊ó÷≤◊û◊ï÷π◊®|chamor|donkey||noun|◊ô◊© ◊ú◊ô ◊ó◊û◊ï◊® ◊û◊ì◊ë◊®|yesh li chamor medaber|I've got a talking donkey|00:05:39|shrek1 top50 casual
◊†÷∞◊°÷¥◊ô◊õ÷∏◊î|nesicha|princess||noun|◊î◊ô◊î ◊î◊ô◊ô◊™◊î ◊§◊¢◊ù ◊†◊°◊ô◊õ◊î ◊ô◊§◊î◊§◊ô◊ô◊î|haya hayta pa'am nesicha yafefiya|Once upon a time there was a lovely princess|00:00:46 - Storybook opening|shrek1 top50 formal
◊ë÷∞÷º◊°÷µ◊ì÷∂◊®|beseder|okay; alright; in order||expression|◊ë◊°◊ì◊®|beseder|Right|00:04:11|shrek1 top50 casual
◊ë÷∂÷º◊ê÷±◊û÷∂◊™|be'emet|really; truly||adverb|◊õ◊ê◊ô◊ú◊ï ◊©◊ñ◊î ◊ë◊ê◊û◊™ ◊ô◊ß◊®◊î|ke'ilu she'ze be'emet yikre|Like that's ever gonna happen|00:01:25 - Shrek reads storybook|shrek1 top50 casual
◊®◊ï÷π◊¶÷∂◊î|rotse|want; wish||verb|◊û◊ô ◊î◊ô◊î ◊®◊ï◊¶◊î ◊ú◊í◊ï◊® ◊ë◊ó◊ï◊® ◊õ◊ñ◊î|mi haya rotse lagur be'chor kaze|Who'd want to live in a place like that|00:09:54|shrek1 top50
◊¢◊ï÷π◊í|og|ogre||noun|◊ñ◊î◊ô◊®◊ï◊™ - ◊¢◊ï◊í|zehirut - og|Beware - Ogre|00:02:42 - Warning sign|shrek1 top50
◊ú÷¥◊î÷∞◊ô◊ï÷π◊™|lihiyot|to be||verb infinitive|◊ò◊ï◊ë ◊ú◊î◊ô◊ï◊™ ◊ó◊ï◊§◊©◊ô|tov lihiyot chofshi|Good to be free|00:07:55|shrek1 top50
◊®÷∂◊í÷∑◊¢|rega|moment; wait a moment||noun|◊®◊í◊¢! ◊ê◊™◊î ◊ô◊ï◊ì◊¢ ◊û◊î ◊î◊ï◊ê ◊¢◊ú◊ï◊ú ◊ú◊¢◊©◊ï◊™|rega! ata yodea ma hu alul la'asot|Whoa, hold on! Do you know what that thing can do to you|00:03:39|shrek1 top50 casual
◊û÷∑◊©÷∂÷º◊î◊ï÷º|mashehu|something||pronoun|◊ê◊†◊ô ◊ô◊õ◊ï◊ú ◊ú◊î◊í◊ô◊ì ◊ú◊ö ◊û◊©◊î◊ï?|ani yachol lehagid lecha mashehu?|Can I say something to you?|00:07:34|shrek1 top50
◊ê◊ï÷º◊ú÷∑◊ô|ulay|maybe; perhaps||adverb|◊ê◊ï◊ú◊ô ◊®◊ê◊ô◊™ ◊ñ◊ë◊ï◊ë ◊¢◊£|ulay ra'ita zvuv af|You might have seen a house fly, maybe even a super fly|00:06:30|shrek1 top50
◊ê◊ï÷π◊ß÷µ◊ô|okay|okay; alright||interjection|◊ê◊ï◊ß◊ô◊ô! ◊ê◊ë◊ú ◊®◊ß ◊ú◊ú◊ô◊ú◊î ◊ê◊ó◊ì|okay! aval rak lelayla echad|Okay! Okay! But one night only|00:10:52|shrek1 top50 casual
◊ê◊ï÷π◊î÷µ◊ë|ohev|love; like||verb|◊ê◊†◊ô ◊û◊ì◊ë◊®. ◊ê◊†◊ô ◊ê◊ï◊î◊ë ◊ú◊ì◊ë◊®|ani medaber. ani ohev ledaber|He does. I can talk. I love to talk|00:06:04 - Donkey introduces himself|shrek1 top50
◊ô÷∏◊õ◊ï÷π◊ú|yachol|can; to be able||verb|◊ê◊†◊ô ◊ô◊õ◊ï◊ú ◊ú◊î◊í◊ô◊ì ◊ú◊ö ◊û◊©◊î◊ï?|ani yachol lehagid lecha mashehu?|Can I say something to you?|00:07:34|shrek1 top50
◊ê÷µ◊ô◊ñ÷∂◊î|eize|which; what kind of; some||interrogative|◊õ◊ê◊ô◊ú◊ï ◊©◊ñ◊î ◊ë◊ê◊û◊™ ◊ô◊ß◊®◊î. ◊ê◊ô◊ñ◊î ◊ë◊ï◊õ◊ò◊î ◊©◊ú|ke'ilu she'ze be'emet yikre. eize buchta shel|Like that's ever gonna happen. What a load of|00:01:28|shrek1 top50 casual
◊ê÷∂◊ó÷∏◊ì|echad|one||numeral|◊ê◊ï◊ß◊ô◊ô! ◊ê◊ë◊ú ◊®◊ß ◊ú◊ú◊ô◊ú◊î ◊ê◊ó◊ì|okay! aval rak lelayla echad|Okay! Okay! But one night only|00:10:52|shrek1 top50
◊î÷∑◊ë÷¥÷º◊ô◊¶÷∏◊î|habitza|the swamp||noun|◊ï◊î◊ô◊ê ◊ú◊î◊ó◊ñ◊ô◊® ◊ê◊™ ◊î◊ë◊ô◊¶◊î ◊©◊ú◊ô ◊ú◊®◊©◊ï◊™◊ô|vehi lehachzir et habitza sheli lirshuti|a quest to get my swamp back|00:25:44|shrek1 top50
◊ê÷¥◊ô◊©◊Å|ish|man; person||noun|◊ê◊ö ◊ê◊ô◊© ◊û◊î◊ù ◊ú◊ê ◊î◊¶◊ú◊ô◊ó|ach ish mehem lo hitzliach|but none prevailed|00:01:12 - Storybook opening|shrek1 top50 formal
◊ë÷∞÷º◊ë÷∑◊ß÷∏÷º◊©÷∏◊Å◊î|bevakasha|please; you're welcome||expression|◊ë◊ë◊ß◊©◊î, ◊ê◊ú ◊™◊û◊°◊®◊ô ◊ê◊ï◊™◊ô|bevakasha, al timseri oti|Please don't turn me in|00:05:19|shrek1 top50
◊ú÷∞◊ì÷∑◊ë÷µ÷º◊®|ledaber|to speak; to talk||verb infinitive|◊ê◊†◊ô ◊ê◊ï◊î◊ë ◊ú◊ì◊ë◊®|ani ohev ledaber|I love to talk|00:06:04 - Donkey introduces himself|shrek1 top50 casual
◊ó÷≤◊ë÷µ◊®÷¥◊ô◊ù|chaverim|friends||noun|◊ê◊ô◊ü ◊ú◊ô ◊ó◊ë◊®◊ô◊ù|ein li chaverim|But, uh, I don't have any friends|00:08:06 - Donkey talks to Shrek|shrek1 top50
◊ë÷∏÷º◊ê|ba|come; enter||verb|◊õ◊ê◊ô◊ú◊ï ◊©◊ñ◊î ◊ë◊ê◊û◊™ ◊ô◊ß◊®◊î|ke'ilu she'ze be'emet yikre|Like that's ever gonna happen|00:01:25 - Shrek reads storybook|shrek1 top50 casual
◊™÷¥÷º◊®÷∞◊ê÷∂◊î|tir'e|you will see; look||verb|◊™◊®◊ê◊î, ◊ú◊ê ◊õ◊ï◊ú◊ù ◊ê◊ï◊î◊ë◊ô◊ù ◊ë◊¶◊ú◊ô◊ù|tir'e, lo kulam ohavim betsalim|Oh, you both have layers. Oh.|00:27:27 - Donkey responds to layers|shrek1 top50 casual
◊©÷∞◊Å◊õ÷∏◊ë◊ï÷π◊™|shchavot|layers||noun|◊ú◊ê! ◊©◊õ◊ë◊ï◊™! ◊ú◊ë◊¶◊ú◊ô◊ù ◊ô◊© ◊©◊õ◊ë◊ï◊™|lo! shchavot! labetsalim yesh shchavot|No! Layers! Onions have layers!|00:27:13 - Shrek explains ogres|shrek1 top50 idiom
◊¢÷∑◊õ÷∞◊©÷∏◊Å◊ô◊ï|achshav|now||adverb|◊¢◊õ◊©◊ô◊ï ◊ê◊†◊ó◊†◊ï ◊û◊™◊ß◊ì◊û◊ô◊ù|achshav anachnu mitkadmim|Oh, now we're getting somewhere|00:47:25 - Dragon encounter|shrek1 top50
◊¢◊ï÷π◊©÷∂◊Ç◊î|oseh|do; make||verb|◊û◊î ◊ê◊™◊î ◊¢◊ï◊©◊î?|ma ata oseh?|What are you doing?|00:36:05 - Fiona questions Shrek|shrek1 top50
◊ú÷∞◊°÷∑◊§÷µ÷º◊®|lesaper|to tell; to relate||verb infinitive|◊®◊ï◊ï◊ß◊î ◊û◊°◊§◊® ◊ê◊ó◊™|ravaka mispar achat|Bachelorette number one|00:18:32 - Farquaad's game show|shrek1 top50 formal
◊§÷∑÷º◊¢÷∑◊ù|pa'am|time; once||noun|◊î◊ô◊î ◊î◊ô◊ô◊™◊î ◊§◊¢◊ù ◊†◊°◊ô◊õ◊î ◊ô◊§◊î◊§◊ô◊ô◊î|haya hayta pa'am nesicha yafefiya|Once upon a time there was a lovely princess|00:00:46 - Storybook opening|shrek1 top50 formal
◊ó◊ï÷π◊©÷µ◊Å◊ë|choshev|think||verb|◊ê◊†◊ô ◊ó◊ï◊©◊ë ◊©◊î◊ï◊ê ◊©◊ù ◊ë◊§◊†◊ô◊ù|ani choshev shehu sham bifnim|Think it's in there?|00:03:37 - Mob arrives at swamp|shrek1 top50`;

        // Parse vocabulary data
        const words = vocabData.trim().split('\n').map(line => {
            const parts = line.split('|');
            return {
                hebrew: parts[0],
                translit: parts[1],
                english: parts[2],
                pos: parts[4],
                exampleHeb: parts[5],
                exampleTranslit: parts[6],
                exampleEng: parts[7],
                timestamp: parts[8],
                tags: parts[9]
            };
        });

        let currentGame = null;
        let gameState = {};

        // Utility functions
        function shuffle(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function getRandomWords(count, exclude = []) {
            const available = words.filter(w => !exclude.includes(w));
            return shuffle(available).slice(0, count);
        }

        function startGame(gameType) {
            document.getElementById('gameSelector').style.display = 'none';
            document.querySelectorAll('.game-container').forEach(g => g.classList.remove('active'));
            
            currentGame = gameType;
            
            if (gameType === 'speedQuiz') {
                document.getElementById('speedQuiz').classList.add('active');
                initSpeedQuiz();
            } else if (gameType === 'matching') {
                document.getElementById('matching').classList.add('active');
                initMatching();
            } else if (gameType === 'fillBlank') {
                document.getElementById('fillBlank').classList.add('active');
                initFillBlank();
            } else if (gameType === 'speedRound') {
                document.getElementById('speedRound').classList.add('active');
                initSpeedRound();
            }
        }

        function backToMenu() {
            if (gameState.timer) clearInterval(gameState.timer);
            document.querySelectorAll('.game-container').forEach(g => g.classList.remove('active'));
            document.getElementById('gameSelector').style.display = 'grid';
            currentGame = null;
        }

        // SPEED QUIZ
        function initSpeedQuiz() {
            gameState = {
                score: 0,
                currentQ: 0,
                timeLeft: 60,
                questions: shuffle(words).slice(0, 10)
            };
            
            document.getElementById('quizScore').textContent = '0';
            document.getElementById('quizTimer').textContent = '60';
            
            startQuizTimer();
            showQuizQuestion();
        }

        function startQuizTimer() {
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                document.getElementById('quizTimer').textContent = gameState.timeLeft;
                
                if (gameState.timeLeft <= 10) {
                    document.getElementById('quizTimer').classList.add('warning');
                }
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timer);
                    showQuizResults();
                }
            }, 1000);
        }

        function showQuizQuestion() {
            if (gameState.currentQ >= gameState.questions.length) {
                clearInterval(gameState.timer);
                showQuizResults();
                return;
            }
            
            const word = gameState.questions[gameState.currentQ];
            const wrongAnswers = getRandomWords(3, [word]);
            const allOptions = shuffle([word, ...wrongAnswers]);
            
            document.getElementById('quizProgress').textContent = 
                `${gameState.currentQ + 1}/${gameState.questions.length}`;
            
            const html = `
                <div class="question-card">
                    <div class="hebrew-text">${word.hebrew}</div>
                    <div class="translit-text">${word.translit}</div>
                    <div class="context-hint">${word.timestamp}</div>
                    <div class="options">
                        ${allOptions.map(opt => `
                            <button class="option-btn" onclick="checkQuizAnswer('${opt.english}', '${word.english}')">
                                ${opt.english}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('quizContent').innerHTML = html;
        }

        function checkQuizAnswer(selected, correct) {
            const buttons = document.querySelectorAll('#quizContent .option-btn');
            buttons.forEach(btn => {
                btn.disabled = true;
                if (btn.textContent.trim() === correct) {
                    btn.classList.add('correct');
                }
                if (btn.textContent.trim() === selected && selected !== correct) {
                    btn.classList.add('incorrect');
                }
            });
            
            if (selected === correct) {
                gameState.score += 10;
                document.getElementById('quizScore').textContent = gameState.score;
            }
            
            gameState.currentQ++;
            setTimeout(showQuizQuestion, 1500);
        }

        function showQuizResults() {
            const percentage = Math.round((gameState.score / (gameState.questions.length * 10)) * 100);
            let message = '';
            if (percentage >= 90) message = 'üéâ Excellent! You\'re a Hebrew master!';
            else if (percentage >= 70) message = 'üëç Great job! Keep practicing!';
            else if (percentage >= 50) message = 'üëè Good effort! Review and try again!';
            else message = 'üí™ Keep studying! You\'ll get there!';
            
            document.getElementById('quizContent').innerHTML = `
                <div class="results-screen">
                    <h2>Quiz Complete!</h2>
                    <div class="results-score">${percentage}%</div>
                    <div class="results-message">${message}</div>
                    <p>Score: ${gameState.score} points</p>
                    <button class="play-again-btn" onclick="initSpeedQuiz()">Play Again</button>
                    <button class="play-again-btn" onclick="backToMenu()">Back to Menu</button>
                </div>
            `;
        }

        // MATCHING GAME - FIXED with transliteration
        function initMatching() {
            const selectedWords = getRandomWords(6);
            const cards = [];
            
            selectedWords.forEach(word => {
                cards.push({ 
                    type: 'hebrew', 
                    main: word.hebrew,
                    sub: word.translit,
                    id: word.english 
                });
                cards.push({ 
                    type: 'english', 
                    main: word.english,
                    sub: '',
                    id: word.english 
                });
            });
            
            gameState = {
                cards: shuffle(cards),
                selected: [],
                matched: [],
                moves: 0,
                startTime: Date.now()
            };
            
            startMatchTimer();
            renderMatchingGrid();
        }

        function startMatchTimer() {
            gameState.timer = setInterval(() => {
                const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
                document.getElementById('matchTimer').textContent = elapsed;
            }, 1000);
        }

        function renderMatchingGrid() {
            const html = gameState.cards.map((card, index) => `
                <div class="match-card ${gameState.matched.includes(card.id) ? 'matched' : ''}" 
                     onclick="selectMatchCard(${index})" 
                     data-index="${index}">
                    <div class="card-main">${card.main}</div>
                    ${card.sub ? `<div class="card-sub">${card.sub}</div>` : ''}
                </div>
            `).join('');
            
            document.getElementById('matchingGrid').innerHTML = html;
        }

        function selectMatchCard(index) {
            const card = gameState.cards[index];
            
            if (gameState.matched.includes(card.id) || 
                gameState.selected.some(s => s.index === index)) {
                return;
            }
            
            gameState.selected.push({ index, id: card.id });
            
            const cardElement = document.querySelector(`[data-index="${index}"]`);
            cardElement.classList.add('selected');
            
            if (gameState.selected.length === 2) {
                gameState.moves++;
                document.getElementById('matchMoves').textContent = gameState.moves;
                
                setTimeout(() => checkMatch(), 500);
            }
        }

        function checkMatch() {
            const [first, second] = gameState.selected;
            
            if (first.id === second.id) {
                gameState.matched.push(first.id);
                document.getElementById('matchScore').textContent = 
                    `${gameState.matched.length}/6`;
                
                if (gameState.matched.length === 6) {
                    clearInterval(gameState.timer);
                    setTimeout(showMatchResults, 500);
                }
            } else {
                const firstCard = document.querySelector(`[data-index="${first.index}"]`);
                const secondCard = document.querySelector(`[data-index="${second.index}"]`);
                firstCard.classList.add('wrong');
                secondCard.classList.add('wrong');
                setTimeout(() => {
                    firstCard.classList.remove('wrong');
                    secondCard.classList.remove('wrong');
                }, 500);
            }
            
            gameState.selected.forEach(s => {
                const card = document.querySelector(`[data-index="${s.index}"]`);
                card.classList.remove('selected');
            });
            
            gameState.selected = [];
            renderMatchingGrid();
        }

        function showMatchResults() {
            const timeSeconds = Math.floor((Date.now() - gameState.startTime) / 1000);
            const score = Math.max(1000 - (gameState.moves * 10) - timeSeconds, 0);
            
            document.getElementById('matchingGrid').innerHTML = `
                <div class="results-screen" style="grid-column: 1/-1;">
                    <h2>All Pairs Matched!</h2>
                    <div class="results-score">${score}</div>
                    <div class="results-message">
                        Time: ${timeSeconds}s | Moves: ${gameState.moves}
                    </div>
                    <button class="play-again-btn" onclick="initMatching()">Play Again</button>
                    <button class="play-again-btn" onclick="backToMenu()">Back to Menu</button>
                </div>
            `;
        }

        // FILL IN THE BLANK - FIXED with transliteration and clear blank
        function initFillBlank() {
            gameState = {
                score: 0,
                currentQ: 0,
                questions: shuffle(words).slice(0, 10)
            };
            
            showBlankQuestion();
        }

        function showBlankQuestion() {
            if (gameState.currentQ >= gameState.questions.length) {
                showBlankResults();
                return;
            }
            
            const word = gameState.questions[gameState.currentQ];
            const wrongAnswers = getRandomWords(3, [word]);
            const allOptions = shuffle([word, ...wrongAnswers]);
            
            document.getElementById('blankProgress').textContent = 
                `${gameState.currentQ + 1}/${gameState.questions.length}`;
            
            // Create sentence with highlighted blank
            const sentence = word.exampleHeb.replace(word.hebrew, '<span class="blank-placeholder">[____]</span>');
            const sentenceTranslit = word.exampleTranslit.replace(word.translit, '[____]');
            
            const html = `
                <div class="sentence-display">
                    <div class="sentence-text">${sentence}</div>
                    <div class="sentence-translit">${sentenceTranslit}</div>
                    <div class="english-hint">"${word.exampleEng}"</div>
                    <div class="context-hint">${word.timestamp}</div>
                </div>
                <div class="options">
                    ${allOptions.map(opt => `
                        <button class="option-btn" onclick="checkBlankAnswer('${opt.hebrew}', '${word.hebrew}')">
                            <div style="font-size: 1.2em; margin-bottom: 5px;">${opt.hebrew}</div>
                            <div style="font-size: 0.9em; color: #888; font-style: italic;">${opt.translit}</div>
                        </button>
                    `).join('')}
                </div>
            `;
            
            document.getElementById('blankContent').innerHTML = html;
        }

        function checkBlankAnswer(selected, correct) {
            const buttons = document.querySelectorAll('#blankContent .option-btn');
            buttons.forEach(btn => {
                btn.disabled = true;
                const btnHebrew = btn.querySelector('div:first-child').textContent.trim();
                if (btnHebrew === correct) {
                    btn.classList.add('correct');
                }
                if (btnHebrew === selected && selected !== correct) {
                    btn.classList.add('incorrect');
                }
            });
            
            if (selected === correct) {
                gameState.score += 10;
                document.getElementById('blankScore').textContent = gameState.score;
            }
            
            gameState.currentQ++;
            setTimeout(showBlankQuestion, 1500);
        }

        function showBlankResults() {
            const percentage = Math.round((gameState.score / (gameState.questions.length * 10)) * 100);
            let message = '';
            if (percentage >= 90) message = 'üéâ Perfect! You know these phrases!';
            else if (percentage >= 70) message = 'üëç Excellent work!';
            else if (percentage >= 50) message = 'üëè Good! Keep practicing!';
            else message = 'üí™ Review and try again!';
            
            document.getElementById('blankContent').innerHTML = `
                <div class="results-screen">
                    <h2>Challenge Complete!</h2>
                    <div class="results-score">${percentage}%</div>
                    <div class="results-message">${message}</div>
                    <p>Score: ${gameState.score} points</p>
                    <button class="play-again-btn" onclick="initFillBlank()">Play Again</button>
                    <button class="play-again-btn" onclick="backToMenu()">Back to Menu</button>
                </div>
            `;
        }

        // SPEED ROUND MIX - FIXED to properly shuffle and work
        function initSpeedRound() {
            gameState = {
                totalScore: 0,
                currentRound: 0,
                roundsTotal: 5,
                gameTypes: ['quiz', 'match', 'blank']
            };
            
            nextSpeedRound();
        }

        function nextSpeedRound() {
            if (gameState.currentRound >= gameState.roundsTotal) {
                showSpeedRoundResults();
                return;
            }
            
            gameState.currentRound++;
            const gameType = gameState.gameTypes[Math.floor(Math.random() * gameState.gameTypes.length)];
            
            document.getElementById('speedRoundNum').textContent = 
                `${gameState.currentRound}/${gameState.roundsTotal}`;
            
            if (gameType === 'quiz') {
                document.getElementById('speedType').textContent = '‚ö° Quiz';
                runSpeedQuiz();
            } else if (gameType === 'match') {
                document.getElementById('speedType').textContent = 'üé¥ Match';
                runSpeedMatch();
            } else {
                document.getElementById('speedType').textContent = 'üìù Fill';
                runSpeedBlank();
            }
        }

        function runSpeedQuiz() {
            const word = words[Math.floor(Math.random() * words.length)];
            const wrongAnswers = getRandomWords(3, [word]);
            const allOptions = shuffle([word, ...wrongAnswers]);
            
            const html = `
                <div class="question-card">
                    <div class="hebrew-text">${word.hebrew}</div>
                    <div class="translit-text">${word.translit}</div>
                    <div class="options">
                        ${allOptions.map(opt => `
                            <button class="option-btn" onclick="speedAnswer('${opt.english}', '${word.english}', 10)">
                                ${opt.english}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('speedContent').innerHTML = html;
        }

        function runSpeedMatch() {
            const word = words[Math.floor(Math.random() * words.length)];
            const wrongAnswers = getRandomWords(3, [word]);
            const allOptions = shuffle([word, ...wrongAnswers]);
            
            const html = `
                <div class="question-card">
                    <h3>Match this word:</h3>
                    <div class="hebrew-text">${word.hebrew}</div>
                    <div class="translit-text">${word.translit}</div>
                    <div class="options">
                        ${allOptions.map(opt => `
                            <button class="option-btn" onclick="speedAnswer('${opt.english}', '${word.english}', 15)">
                                ${opt.english}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('speedContent').innerHTML = html;
        }

        function runSpeedBlank() {
            const word = words[Math.floor(Math.random() * words.length)];
            const sentence = word.exampleHeb.replace(word.hebrew, '<span class="blank-placeholder">[____]</span>');
            const wrongAnswers = getRandomWords(3, [word]);
            const allOptions = shuffle([word, ...wrongAnswers]);
            
            const html = `
                <div class="sentence-display">
                    <div class="sentence-text">${sentence}</div>
                    <div class="english-hint">"${word.exampleEng}"</div>
                </div>
                <div class="options">
                    ${allOptions.map(opt => `
                        <button class="option-btn" onclick="speedAnswer('${opt.hebrew}', '${word.hebrew}', 20)">
                            <div style="font-size: 1.1em;">${opt.hebrew}</div>
                            <div style="font-size: 0.85em; color: #888; font-style: italic;">${opt.translit}</div>
                        </button>
                    `).join('')}
                </div>
            `;
            
            document.getElementById('speedContent').innerHTML = html;
        }

        function speedAnswer(selected, correct, points) {
            const buttons = document.querySelectorAll('#speedContent .option-btn');
            buttons.forEach(btn => btn.disabled = true);
            
            if (selected === correct) {
                gameState.totalScore += points;
                document.getElementById('speedScore').textContent = gameState.totalScore;
            }
            
            setTimeout(nextSpeedRound, 1000);
        }

        function showSpeedRoundResults() {
            let message = '';
            if (gameState.totalScore >= 70) message = 'üèÜ Champion! Incredible performance!';
            else if (gameState.totalScore >= 50) message = 'üéâ Excellent! You\'re doing great!';
            else if (gameState.totalScore >= 30) message = 'üëç Good job! Keep it up!';
            else message = 'üí™ Practice makes perfect!';
            
            document.getElementById('speedContent').innerHTML = `
                <div class="results-screen">
                    <h2>Speed Round Complete!</h2>
                    <div class="results-score">${gameState.totalScore}</div>
                    <div class="results-message">${message}</div>
                    <button class="play-again-btn" onclick="initSpeedRound()">Play Again</button>
                    <button class="play-again-btn" onclick="backToMenu()">Back to Menu</button>
                </div>
            `;
        }
    </script>
</body>
</html>